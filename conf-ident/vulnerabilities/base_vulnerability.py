class Vulnerability:
    def __init__(self, name, severity, description, recommendation, cve_id=None):
        self.name = name
        self.severity = severity  # 'low', 'medium', 'high', 'critical'
        self.description = description
        self.recommendation = recommendation
        self.cve_id = cve_id
        self.affected_files = []
        self.matched_lines = {}
        self.file_path = None
        self.line_number = None
        self.config_section = None

    def add_affected_file(self, file_path, line_numbers=None):
        self.affected_files.append(file_path)
        self.file_path = file_path
        if line_numbers:
            self.matched_lines[file_path] = line_numbers
            self.line_number = line_numbers[0] if line_numbers else None

    def to_dict(self):
        return {
            'name': self.name,
            'severity': self.severity,
            'description': self.description,
            'recommendation': self.recommendation,
            'cve_id': self.cve_id,
            'affected_files': self.affected_files,
            'matched_lines': self.matched_lines
        } 